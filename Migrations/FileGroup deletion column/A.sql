
-- Some of this script modified from https://stackoverflow.com/questions/6121917/automatic-rollback-if-commit-transaction-is-not-reached

delimiter //
create procedure migration()
begin 
   DECLARE exit handler for sqlexception
      BEGIN
      
      GET DIAGNOSTICS CONDITION 1 @p1 = RETURNED_SQLSTATE, @p2 = MESSAGE_TEXT;
	  SELECT @p1, @p2, "ERROR999";
     
      ROLLBACK;
   END;

   DECLARE exit handler for sqlwarning
     BEGIN
      GET DIAGNOSTICS CONDITION 1 @p1 = RETURNED_SQLSTATE, @p2 = MESSAGE_TEXT;
	  SELECT @p1, @p2, "ERROR999";
	  
     ROLLBACK;
   END;
   
   START TRANSACTION;
   
UPDATE FileGroup SET deleted = 1 where fileGroupUUID in (
'002E6BF7-656A-42DA-9DB1-9749DCEC9ED6',
'0E06AC4D-DE4F-4E02-B11A-862A2A2644C4',
'10B8FB6F-B975-456B-A571-E4548CB51542',
'15BF6966-318C-4889-9F89-C651CAA20A69',
'15E72B69-419B-4944-AAFD-B76DA88AFD16',
'17B12C3B-0A76-4F8E-AB07-F171C2308FC1',
'19AC389E-04F1-4572-9FE4-C6121E93A687',
'24D334F5-A14F-4020-9C65-E251D96353E2',
'30A64765-9C4D-4D68-967C-6B2F3301DE63',
'333A0246-A23B-47EA-B8C7-E48A23DA5B55',
'3F4821FB-D658-4E7A-90A1-DFF7259C6D50',
'3F4B04DC-B1C6-4415-ACA8-644B7C0F5FE9',
'43F3DDE6-1B05-4451-B019-A729D5983CE5',
'464E9E03-8C09-4E9C-94BD-98A9B16360F0',
'46ECFB1B-757B-413D-BB3E-BC6ADBA87FDB',
'470AF4C8-F669-4C14-B3F3-FB3AF246D1A7',
'4876F75E-6A57-46A0-A5CC-6E5B26D82D98',
'4A093888-B9EF-47AA-82B7-83588A269D07',
'4A6DB6E9-C065-4F33-AC59-69414950734C',
'4D9B20BC-0D0D-40CA-B504-F01E0204A29E',
'51128C41-D6FF-4910-B7C1-B1C59E2C3E78',
'54E6E70A-CBE3-4848-A912-4D38447F60F8',
'59C0005E-79E8-448C-A62A-7FA091DD1FFB',
'5C89E7B0-7C81-4372-A4E4-5210EFA599F3',
'5FA237AA-5721-4B35-B778-619FD8CA43D9',
'68F69A38-2890-4BE9-8D10-948BAB4C0678',
'6C53589B-1B44-4E0C-83C9-81A107DD3534',
'6F2055FD-3600-4E8B-A794-A385F4A0B97E',
'793B87E2-8C17-4D46-8257-ABEAABFD8A25',
'82E21EE7-FA45-4B32-86E9-3E7AB2480A51',
'835E3763-3246-4635-97FC-57FCF240E9C5',
'83BC31BA-248F-4AF7-AE05-EABA9C163A8C',
'8ABB880C-A7FF-44DC-800C-421CB8ECD211',
'8CE5DE38-858D-4CFB-A30B-0B9C8DE4DB7C',
'8E02F3A5-2BE7-4D8E-82D2-D44A6BF1CBDC',
'95BA602D-D35B-467E-8E15-68F73A6927AB',
'9AB6129B-D124-42EE-985E-61C84CD0C277',
'9BE6EFC2-A824-4924-8C1E-6DEC044C9669',
'9D51775F-6557-47E8-8840-B8874457195B',
'A15CC95E-298C-49E1-A351-68FF0AB2E1E8',
'AB75E9AA-2C1F-4059-9B5E-71CEA8E4796E',
'AC8970E7-DCF2-4A86-8C42-96B3835FB760',
'ADDB09F1-706A-4459-A40B-0F8F3BAD2038',
'AE956A47-1129-4D2D-8483-4C84A32550B6',
'B56AB11A-0BD3-4F76-9F12-A05A4D7D1901',
'B56B3ED0-A169-4223-8368-382CD5D8A80B',
'B5C48129-B137-4641-BF63-332627A5B9E4',
'BF586592-DC10-4E8F-8BB2-97A05B33D757',
'C31141BD-1A46-4C3F-8EE6-3B08D65E2265',
'C56E49A2-1FC2-4B73-A9AE-4B7BCF18EBA3',
'CC2E2077-7F11-4DAF-AEBC-2263019E1EA6',
'D02FF447-86A2-4BCA-867D-FA4E15D0C549',
'D0A27058-E9E5-463F-B791-82A615E27853',
'D0E1373A-2BD1-47BC-89EF-95DB33D557E9',
'D13CA353-DF63-45C2-825B-077995C1BDED',
'D4C6F4AB-3639-4496-B7E6-A4E59ABC8380',
'D660CE09-9503-41C5-B852-6D7AE2FDCC95',
'DB8A4641-3A34-4DDD-8A0C-CAEAA1C8E910',
'EC8759F8-AC2B-4F2D-9367-7554CE62B1A8',
'ECA465B6-A1F5-4FA4-8B89-12DC26828F2E',
'F18AE47E-C055-4EA0-9EE3-8ECE29EA91FE',
'F3494338-9823-4762-85FA-3ED2218F1127',
'FA08AD76-90E6-40F3-864A-826FC68E4642',
'FF136E03-710F-40F9-80FB-95546900F388'
);

		SELECT "SUCCESS123";
		
   COMMIT;
   
end//
delimiter ;

-- Not needed because the command line invocation of mysql specifies the database.
-- Use SyncServer_SharedImages;

call migration();
drop procedure migration;

